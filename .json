{
    "title" : "AWS EC2でサーバー(LAMPスタック)を構築してみる #1",
    "subtitle": "~VPC作成からEC2起動まで~",
    "summary": [
        "今回はAWSを利用してサーバーを構築してみます。",
        "本記事ではEC2を立ち上げるところまでまとめてみます。"
    ],
    "outline" : [
        "VPC・その他リソース（サブネット・ルートテーブルなど）の作成",
        "ネットワーク設定(ルーティングなど)",
        "EC2 インスタンス作成",
        "インスタンスへのssh接続確認"
    ],
    "contents" : [
        {
            "text" : [
                {
                    "type": "normal",
                    "content": [
                        "VPCはAWS上で作成できるプライベートな仮想ネットワーク空間です。",
                        "自分のアカウント（内）でその他のAWSリソース（サブネット・ルートテーブルなど）を用いて設定をすることで専用のネットワークを作成できます。",
                        "オンプレでサーバーのネットワークなどの設定をするのと位置づけ的には同じ感じだと思います。",
                        "VPCを利用して作ったネットワーク内にEC2など必要なリソースを配置してサーバーを構築していきます。",
                        "早速作成してみます !!",
                        "AWSコンソール画面でVPCを選択して画面の「VPCを作成」をクリックすると作成画面を開くことができます。",
                        "↓今回はVPCなどを選択してその他のリソースも自動で作られるようにして左下の「VPCを作成」して作成されたことを確認します。",
                        "VPCが作成できたのでネットワークの設定を進めていきます。"
                    ],
                    "image": {
                        "6" : "VPC Management Console - ap-northeast-1.console.aws.amazon.com.png",
                        "8" : "VPC Management Console - ap-northeast-1.console.aws.amazon.com-1.png"
                    }
                }
            ]
        },
        {
            "text" : [
                {
                    "type": "normal",
                    "content": [
                        "デフォルトではネットワークに接続することができないのでインターネットに接続するために各設定を進めていきます。"
                    ]
                },
                {
                    "type": "list",
                    "content": {
                        "インターネットゲートウェイのアタッチ" : {
                            "text": [
                                "インターネットゲートウェイはVPCが外部ネットワークとの通信を可能にする役割を持っています。",
                                "上記のやり方だと自動でVPCにアタッチされていますが念のため確認しておきます。",
                                "左のメニューから「インターネットゲートウェイ」を選びます。",
                                "状態がAtachedになっていればアタッチされています。"
                            ],
                            "image": {
                                "4" : "gateway.png"
                            }
                        },
                        "ルーティングテーブルに設定追加" : {
                            "text": [
                                "VPCにインターネットゲートウェイをアタッチするだけではサブネットが外部アクセスができないのでアタッチしたゲートウェイを介して通信ができるようにルートを設定します。",
                                "以下のような設定を追加するとlocal向けの通信以外のすべての通信は(0.0.0.0/0)インターネットゲートウェイへ向かう（igw）ようになりました。",
                                "この設定で外部⇔igw⇔VPCに関連づいたパブリックサブネットのネットワーク経路が確保できたのでこのサブネットにインスタンスを作成すると外部からインスタンスに接続して操作ができるようになります。"
                            ],
                            "image": {
                                "3" : "routing.png"
                            }
                        }
                    }
                }
            ]
        },
        {
            "text" : [
                {
                    "type": "normal",
                    "content": [
                        "VPC作成・設定ができたのでEC2インスタンスを作成・起動します。",
                        "AWSコンソール画面でEC2を選択して画面を開きます。",
                        "適当な名前と必要なOSイメージ・インスタンスタイプ・キーペアを設定した後ネットワーク設定をいじっていきます。"
                    ],
                    "image": {
                        "3" : "ec2-network.png"
                    }
                },
                {
                    "type": "list",
                    "content": {
                        "パブリックIPの自動割り当て" : {
                            "text": [
                                "外部から通信をしたいのでグローバルIPが付与されるように「有効化」にします。"
                            ],
                            "image": {
                                
                            }
                        },
                        "インバウンドセキュリティグループのルール" : {
                            "text": [
                                "デフォルトでssh（22）が許可されています。今回はwebサーバーとして機能するようにしたいのでhttp・httpsプロトコル用のルールを追加しておきます。",
                                "今回はすべての通信を許可するのでアドレスを0.0.0.0/0にしておきます。"
                            ],
                            "image": {
                                "2" : "security-group.png"
                            }
                        }
                    }
                },
                {
                    "type": "normal",
                    "content": [
                        "設定をしたら起動をしてみます。起動できていることを確認できました！"
                    ],
                    "image": {
                        "3" : "ec2-success.png"
                    }
                }
            ]
        },
        {
            "text" : [
                {
                    "type": "normal",
                    "content": [
                        "sshコマンドで接続して確認してみます"
                    ],
                    "image": {
                    }
                },
                {
                    "type": "code",
                    "content": [
                        "$ ssh -i [プライベートキー (.pem) のパスとファイル名] [インスタンスのユーザー名]@[インスタンスの DNS 名]"
                    ],
                    "image": {
                        "1" : "ec2-login.png"
                    }
                },
                {
                    "type": "normal",
                    "content": [
                        "接続確認できました！",
                        "今回はここまでです。次回からLinuxを操作しながらLAMP環境構築をしてみます。"
                    ]
                }
            ]
        }
    ],
    "category": ["AWS", "EC2"],
    "imageDirectory": "aws-1"
}